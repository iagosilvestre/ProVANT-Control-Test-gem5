#include "Icontroller.hpp"
#include <iostream>
#include <Eigen/Eigen>
#include "simulator_msgs/Sensor.h"
#include "math.h"
#include "vant2load_hinfinity/feedfoward.h"


class hinfinity : public Icontroller 
{
	private: Eigen::VectorXd Xref;
	private: Eigen::VectorXd Erro;
	private: Eigen::VectorXd Input;
	private: Eigen::MatrixXd K;
	private: Eigen::VectorXd X;
	private: double T;

	public: hinfinity(): Xref(24), K(4,24), X(24), Erro(24), Input(4)
	{ 
		T = 0.012;
	}
	public: ~hinfinity()
	{
		
	}
	public: void config()
	{
               /* K << -0.7427148050457406,11.6291350647269,12.21926718374182,-27.10728485197495,-0.4648008838023821,
                        -0.006803726043134804,21.14633193569281,0.03197698680144821,-0.004691210349831838,0.007370660144078335,
                        -0.4489019159773146,7.069721284465932,5.509202904860204,-6.4466094724022,-0.03180858498410459,
                        0.09281557096634983,2.250120765898164,-0.01263612343339242,-0.0009502553709670123,0.000904077996246642,
                        -0.6141451796123456,9.514220044338314,11.39860645438513,-0.05354842926298398,

                        -1.187046725018393,-13.64004499030525,11.34432909409471,28.4128279839608,-0.8725713942772159,
                        0.01222433036483736,-21.0471850511619,0.1314147782935957,-0.008843459956589264,-0.04339282907757867,
                        -0.608943858516616,-8.138091968395761,5.649159793577877,6.494906022012327,-0.07428381341425691,
                        -0.08667173447613465,-2.208968336420121,-0.01669931194218644,0.0008899571183776669,-0.001181449168263043,
                        -1.153316588913227,-11.35659069245753,9.842704332397604,0.06680140988587036,

                        0.2610463183890839,-0.04828535303380414,-0.003091691958594755,0.1035320352600452,0.3710635728722768,
                        0.05005573731618031,-0.07214480619058318,-0.1609146607705521,0.162188147215873,-0.01828095491018243,
                        0.1297216342205925,-0.02936817855150754,-0.007005901229838768,0.02423661359102285,0.06490936167879954,
                        0.02908848308904742,-0.005843469665565864,-0.006289048181751159,0.0043871808308894,-0.0001277831759556683,
                        0.2559249379379727,-0.04061991349827818,0.007584920974213,0.02263911155772615,

                        0.2497801488248539,0.001769181465250185,-0.002289072544127605,-0.03152314952533411,0.3663052874985554,
                        -0.08026288689241383,0.03322417458688194,-0.1625863055112106,-0.01542595160486103,0.1600546904814939,
                        0.1261393334368762,0.004572913791558271,-0.007270862963479085,-0.008761143104208323,0.06561346215605705,
                        -0.03061052159970393,0.002930794796090557,-0.006519396873853966,-0.0001603309740714778,0.004441146012198666,
                        0.2420962688322702,-0.004142768430832517,0.006928387100675009,-0.05973647374724567;*/

		//K << -2.313788779662107,30.61091077559081,23.93694206064045,-58.45649153317599,-0.6442565743493727,0.4833632728802997,35.82422398029323,-0.007861022805138366,0.2600793449059194,-0.2392656011079205,-0.9033698228634192,17.30793398266993,7.83749915380368,-12.15065098743038,-0.03433777644198512,0.3568620459749081,2.806793943760144,-0.0202128962478302,5.012818077345488e-05,7.999971462708586e-05,-2.511816760412831,25.5813872823238,29.17118315865461,0.1629205749071583,-2.649779949332447,-35.33477294738441,21.79647973147359,59.68596431473199,-0.9439499001979254,-0.6546749166608581,-35.76940534877593,0.06335688864011446,-0.2159347588598702,0.2074954091412763,-1.019855037725663,-19.07954187803056,7.707125312317927,12.18488970415328,-0.0595169852029667,-0.2977404346900951,-2.789651009981861,-0.02619386121119138,0.0009595511443226207,-0.0005144774891609994,-2.872846793946176,-30.70784809500843,25.8590133837739,0.203648718771564,0.5155508728296131,-0.1087485900100827,0.01538713807025068,0.186571665772432,0.7264289790625198,0.1654449654053402,-0.1019824058543034,-0.2854517547142238,0.2595048614482072,-0.03397478266882722,0.2554112010763965,-0.0595730885365592,-0.001116996556593772,0.03781352800532947,0.1233795618422877,0.07808566633596364,-0.006920274179670709,-0.009084353702851848,0.005414383357414812,-0.00030340325118485,0.4795978301599128,-0.09486120810131532,0.01958659678390315,0.05858445550366691,0.5261079067118212,0.07834596902516862,0.01986151068810952,-0.144625309451881,0.7468933118573835,-0.1414395307218379,0.08354762638554548,-0.2930307917559467,-0.02595161084660807,0.2536260083657125,0.2618181705424096,0.04351272710282675,-0.0008057691925876464,-0.02909366739856974,0.1277627100817131,-0.08762882446370268,0.005570387898229627,-0.009282353994379235,-0.0004131291708625687,0.005549081547576798,0.4898500979121368,0.06799632850117113,0.02789848490449524,-0.09441677586663225;
                
		//K << -2.361114032932635,29.92916296314503,23.92169279547031,-57.01609850619609,-0.6803885438268078,1.108726444194066,35.35793926330083,-0.003921908087852133,0.4677660551924895,-0.4488939712954939,-0.9202815895652854,16.90273413463989,7.832744732200319,-11.92796942638978,-0.03679709640521606,0.6722480024069327,2.792796757982402,-0.02073767402299331,0.004733027219082232,-0.004557173251371836,-2.567788159323372,24.71875372397956,29.13678971157462,0.6156375040628441,-2.677781411399695,-34.97015821906204,21.80822119764344,58.71766834843668,-0.9842017698277604,-1.454015143573334,-35.52579768471598,0.07655238631826558,-0.4078181659599814,0.3913206729785093,-1.036681085970833,-18.84271192461036,7.705429174976135,12.05513285476417,-0.06759787034745127,-0.551006780517181,-2.786401668481419,-0.02497236779730959,-0.003544759211700419,0.003702810820928499,-2.91000076337633,-30.16505666848322,25.85918439706731,-0.1448424272282101,0.8255620861579672,-0.07644788097400987,0.02469490431501302,0.134445884635645,1.155562887928264,0.1477077989854939,-0.08127232856912782,-0.4371258896218973,0.3478050561223084,-0.03368442378556252,0.4092076677462471,-0.04211805791566552,-0.0008745982397568326,0.02844250332187761,0.1960676016150297,0.08602238695096751,-0.006257123357731484,-0.01409332022436897,0.007474494782198971,6.403173813714689e-05,0.7630514131642933,-0.06401757405851027,0.0430491230804346,0.06132922943106994,0.8286092944872455,0.05038240922296216,0.0262072682027369,-0.1058260301800682,1.162427847733301,-0.1471512036061265,0.07253671331290067,-0.4405609575037777,-0.02987785499440824,0.3457664451418679,0.4111719831111936,0.02972433660620733,-0.0006980382747250276,-0.02302083985265925,0.1977638033806661,-0.08755401597909129,0.006015020450987145,-0.01420832625627017,4.590454837818998e-05,0.0075077572138203,0.7657784053720054,0.0413305260442891,0.04690496587744985,-0.08390018946160156;
	
	//K << 2.595796170725384,18.82352386865829,16.14760695687785,-48.70129558938642,7.142163130908139,0.7815469884849827,33.7730903367326,-2.422840467435626,0.2548597060842283,0.6622175337083165,1.619232243486419,12.57558407911496,6.438129940711795,-11.09667226908927,1.326616955133824,-0.05767532479411743,2.824772331328347,-0.05775161468666816,0.007378853439059183,0.010524546671794,1.59689525760826,11.64380992557033,13.55408983451354,0.9212810184121455,1.717404800940066,-15.5436139881646,14.14292196526479,36.89437643370442,5.756506691689436,0.1818025702088304,-28.22827080942106,-2.043653159273544,0.9915238314711562,-0.1084896505252999,1.173859887717838,-10.33471269924478,6.218817663024968,8.744431274507184,1.08232500891145,0.74522413339129,-2.538875163466828,-0.05114632087886292,0.01629777682988594,-0.002553549225113496,0.9602775808765663,-9.809756900628528,11.15344482128614,-0.6590403363474641,0.575358348644631,-0.08830441310113646,0.02616101790855058,0.1777284756911445,1.077364026938725,0.1295206952803804,-0.09980905116172989,-0.4542620469511532,0.3470729090786253,-0.02081840599485307,0.3381574397546789,-0.05398398421997828,-0.000267897528122338,0.03714577265254464,0.2000366825178671,0.09284308827847457,-0.006914981424158642,-0.01667665843979446,0.007889329209884688,0.0002712571221605064,0.3912755167285258,-0.05929354066835858,0.03594116820864178,0.03732598241225886,0.4688099978249861,0.09225962174635588,0.02871540846157765,-0.1983511849548469,0.9007063796831892,-0.1311423452552108,0.1118685139235374,-0.4016804613031366,-0.02705947350942297,0.3323772310910144,0.2785034933577056,0.05609275463259029,-2.075723255041351e-05,-0.04055353257714501,0.1711209936769897,-0.0778207880888179,0.007983202268216886,-0.01590377893114303,0.0002755804144020493,0.007464156274221828,0.3167516080425543,0.06248586229698911,0.040280990421775,-0.06092275387796737;
	
	//K << 4.943206258034579,135.7462853276556,48.53860741372657,-169.4964910138191,3.767412683508467,-0.8520730429427528,69.33891842417431,-0.5302426657706062,-1.372041765352383,1.537529962282105,2.050047043587829,64.83822699867535,11.32452394249906,-27.29595003325112,0.3780752445870864,0.7001290211794493,3.665203132162297,-0.00242185979140724,-0.007923583928754739,0.01017713010753804,4.079526150717982,121.2060907264221,73.85722045489317,-3.343822442571676,5.420901275690355,-113.7551859237979,40.82295901069703,148.2245075136438,4.133931274818675,-0.1460874358466799,-63.66878541359469,-0.5844402787280897,0.7939281534975488,-0.6487451834322064,2.187825532867674,-55.24733892657893,10.58275860152733,24.53742690677814,0.4102598992469071,-1.20458691446036,-3.512107222113178,0.0007846077711700821,1.525744311418037e-05,0.001363583662032618,4.18931998520724,-102.166834771717,58.67863399775791,0.6785656743018478,2.550815398722381,-0.1515368243042469,0.09900103823955883,0.2124102302203486,2.431838515073079,0.4077692144636855,-0.100065848454614,-0.6233918109869805,0.3708270470866536,0.003183438238475343,1.086499290291889,-0.07507279388783057,0.01457991324095914,0.0383713444027094,0.3189939004042759,0.08931717570685985,-0.006081161991890225,-0.007626198777947734,0.007944148728259803,0.0001756181000675506,2.520288278036579,-0.1311153559793658,0.2303122268371221,0.5236552488321258,2.511409033920863,0.07505495941860213,0.09887681873220962,-0.1570593626983965,2.413552839462656,-0.4588857597171025,0.08609247371645988,-0.6224058719013679,0.003388567073305691,0.3705041382350559,1.073099389548704,0.04696597486392318,0.01421282799905572,-0.0301986153055095,0.3181566019670538,-0.09394455680507691,0.005881339086673411,-0.007779314207934475,0.0001380126059439339,0.007984801781445651,2.478898883944108,0.0580731293940305,0.232061315529896,-0.5911386532216486;

	//K << 2.291069687413493,20.42013696921163,16.22707299819861,-51.51513963760185,6.641788695541425,-0.1839295998481298,34.91117417644857,-2.275896123101646,0.221952627198021,0.6419562446082512,1.449777355863998,13.48191079794566,6.440809488186345,-11.59525534409262,1.242006451311268,-0.01048828286611938,2.877227743906977,-0.05682394393225414,0.007511204224468076,0.009585828722853585,1.377012573416086,12.77189266141725,13.67282683322748,-0.01255423680549978,2.217631688092643,-16.96320621667429,14.11842555786831,39.38652104968914,6.600728561614479,1.236251433999824,-29.237474633633,-2.305179486088355,1.07932628470673,-0.09448674097076996,1.457974732447918,-11.13632177251733,6.224653380168783,9.18636568933127,1.225722658786953,0.77171892272761,-2.585428339501167,-0.05472309183030415,0.01797519022646611,-0.002477969214495761,1.314319692162641,-10.81521689949292,11.11566081391347,0.323102068397821,0.5880264628437244,-0.09210188615872457,0.0268099842787965,0.1858363455744036,1.098023929283621,0.1705557632660582,-0.1041076218659018,-0.4607665418742161,0.3578691689527985,-0.02910459625888235,0.3451551210522367,-0.05631455092350217,-0.0001920039650436945,0.03878021149553869,0.2034402388460301,0.1102012755522865,-0.007159249493330331,-0.01678922987732089,0.008317917196482364,-0.0001197241191213793,0.4003778947578534,-0.06187345305053548,0.03696314961235854,0.06143848801274444,0.5509549883568351,-0.0549897127204373,0.02565016794962346,0.05829292882677966,1.039704820215062,-0.1474444053434127,0.008858867023580897,-0.4438928168323235,-0.03017657377985549,0.3516113724409827,0.324873697645516,-0.02704786732057862,0.0002354158675750223,0.004979923662797808,0.1946573073452663,-0.1028963124052726,0.003259006454299513,-0.01649956386589498,-9.46074315375823e-05,0.00816363881314444,0.3745772131497991,-0.04170553493311052,0.03555791503415706,-0.05757771706789089;

	K<< 0.7101244468428165,6.141471260155515,7.765440795725267,-18.97385920336097,1.826066960066656,-0.09338611048322061,17.57791369983566,-0.7164683413615529,-0.03350735071807359,0.4235128078145839,0.2708588223207514,4.311055003650324,4.170146360015496,-5.072227698361692,0.3809539101204998,-0.06650607548831029,2.122392130887405,-0.02473442956879733,0.0006404185518007683,0.008513558472367464,0.4662177448319676,3.523707063368016,5.320429316782071,-0.1472247707396855,-1.571274680558446,-8.596271330525751,6.985745062499001,21.91480875426527,-1.94921538690414,0.09535891280953998,-18.42904004957552,0.4434387926540275,0.1072202681687932,-0.317249054464631,-0.9548973567439005,-5.910676814456982,4.55703288130231,5.454379896200787,-0.2518284755625079,0.06360770401465654,-2.133681658482248,-0.008445306788653999,0.001718825918710477,-0.005954099368496411,-1.2250793041699,-5.503330766582297,3.925043415306752,0.09204438852464802,0.1952075590979948,-0.03032542746108816,-0.003380038380425396,0.06292464197787898,0.3808490158409268,0.04098134842638689,-0.0437294922542443,-0.1815063858105274,0.1672299855993115,-0.004950772796723103,0.1160491338776613,-0.01901526180028523,-0.01046202265880625,0.01457474072728251,0.07364843512499895,0.02819675274652457,-0.003764578805403473,-0.008102716027547696,0.004792989032152177,0.000274744109690024,0.1320526541764119,-0.01982603318640202,0.008140109577766043,0.01296630640217303,0.1858289717940038,-0.004531750410384653,-0.001691334240977282,-0.01099980803116952,0.3650350924346544,-0.03429654457475473,0.02114487202233904,-0.1765601446988155,-0.0087900241089497,0.1676412256268605,0.1107587378532268,-0.0008316297740917086,-0.0101361709665762,-0.00430220334492462,0.07112118136129204,-0.02734833615631714,0.002775618184624419,-0.007952050965466266,0.000294409460551884,0.004683773810332413,0.1255028830715101,-0.004335263292000928,0.009748974116588649,-0.01431313055730361;
	
	//K<<-0.2541653821137748,6.775502566282773,7.746350230843811,-19.4739032412521,0.1687446229390521,-0.132437780629421,17.31307057914504,-0.1578067566248007,-0.1625540445924021,0.3690676102785428,-0.270053429588716,4.581752104713837,4.14915944445856,-5.084591899689934,0.1011271812525129,-0.1242261695715598,2.113765884976364,-0.01604605440403266,-0.0008912687292132811,0.007976171360184241,-0.2227946147939034,4.013368534456312,5.302162070698786,0.01948678061182065,-1.084769350957393,-8.369737971132533,7.001084001704577,20.92887559722191,-1.177950884763899,0.2167345273939578,-17.38655297618571,0.2381725069190293,0.1759570507251653,-0.3438178646671096,-0.6926633479779853,-5.711576453326822,4.532268424989066,5.184294797605523,-0.1265028453176758,0.124751446728794,-2.066594983584234,-0.006372566377296202,0.002052197798846109,-0.006857772380108949,-0.8760680001065965,-5.370755238634906,3.976076651384142,0.006243806852155111,0.1630775156354149,0.0002180418079723718,-0.008105093296407531,0.00426835966014453,0.2846126995435641,0.0374260054948569,-0.007807851614118833,-0.1010910286320809,0.1379909686631412,-0.0317533797210935,0.09200052109644329,-0.001342531457402761,-0.01271696992120252,0.002655132503764228,0.05011816911946525,0.02814360355811506,-0.001193447195938454,-0.004192211924625751,0.004344844886252639,-0.0002196405025801508,0.1132442421828913,0.00175886730520099,0.005910998268071416,0.01266152916981107,0.1598803372589616,0.0167399185210011,-0.006779894327726071,-0.04863225353713236,0.2784728670306805,-0.03020486240436507,0.04186202113882142,-0.09875075076962528,-0.03807456400776706,0.1418657940387229,0.0901858512382006,0.01105384067762468,-0.01252828556045407,-0.01139209273972518,0.04913636229708061,-0.02830944711823394,0.004278842545644358,-0.004111475447195833,-0.0001455807593489554,0.004188025471031741,0.1110192087701598,0.01082891320087595,0.007091907119945435,-0.01575271931391535;		

//K << -0.2375553166541329,6.941751242452115,7.779502467618056,-20.37105832534727,0.187423915847707,-0.1418853731923554,18.32723338663901,-0.1589833203419614,-0.1217419192520413,0.3288576491878651,-0.2613309299963336,4.7539476315713,4.179924771794169,-5.343786019279354,0.1026771577548625,-0.07942616101316055,2.17316778150425,-0.01603343753039016,-0.0004984594965440634,0.007566182643665707,-0.2005239155791627,4.114877180031352,5.32837799144799,-0.0006231066464355584,-1.098182179261068,-8.572205599808697,6.972510862708399,21.86158075417709,-1.191075470618673,0.150011121678604,-18.39392615935082,0.2405874795556138,0.1267266490590636,-0.2968342976293769,-0.6993260569454914,-5.899536924044226,4.52918733983115,5.446729618956692,-0.1290249462990281,0.07325241231374939,-2.131453396725045,-0.006429056147363841,0.001423420284710938,-0.006242466863261137,-0.8867483938156392,-5.483677956323946,3.959389516363923,0.04274601207941143,0.1625863511672959,-0.001844084109371005,-0.008509407313149734,0.0111679749075917,0.2828063803902988,0.04653913524878001,-0.01412873546629741,-0.1004795265030994,0.1388792505665097,-0.03330477265362829,0.09177642747030031,-0.003024411507467763,-0.01289582167321895,0.004543805870292869,0.04978182969820873,0.02772913886110885,-0.001784776222394005,-0.00415894941581073,0.004314310559625798,-0.0002206858654210619,0.1135595608429478,0.0005501844057454196,0.005556787044328903,0.007035979924961715,0.161700852622192,0.01518390583640655,-0.007211710843844454,-0.04747159266686409,0.2809913856329284,-0.02773819894841197,0.04262786462154715,-0.09963681386791144,-0.03550995440626937,0.140162609967722,0.09124099441365019,0.01032570907429525,-0.01281720613542397,-0.01140145655388598,0.04962358430338623,-0.02766003666419845,0.004219769029477316,-0.004121218690742314,-0.0001513613444150523,0.004203138644933068,0.1129598691310211,0.009536930646214132,0.006820350901814369,-0.01928100881406367;

//K << 19.91348160524642,31.59168027077996,43.66623581716817,-82.66099833675234,39.25855697476324,-1.525249160684398,53.00845520944605,-12.71414403421887,0.3768494091736134,6.167088798197399,12.05404364246434,21.82814424697018,11.97332814224255,-18.03558177450809,6.675593057330655,-1.438968448911813,3.506686351614409,-0.2836301917208555,0.08967197819698036,0.07654315017805344,13.4253948246991,19.14468216652042,43.93980036679994,-0.8053818051105425,4.698671935097818,-24.25148915317415,41.70718977036161,59.03298284128382,13.69550424163481,0.8111051815439682,-45.66190438034318,-4.854233230510844,6.008408442810005,-3.05821903616473,3.518801103121996,-16.04942227282901,11.65756028023267,14.17331759740614,2.366216391263349,2.91406382501944,-3.395661808914392,-0.133480628100784,0.09333931661715805,-0.03464270201495615,2.722200971892856,-14.99427981800723,42.25750131849271,-0.5799890503344815,0.1806607077118296,-0.02545035877126138,0.001556759403780751,0.0550154826531749,0.3556843861701919,0.03776428014073419,-0.03063473086824285,-0.1734211486626504,0.1556078487631574,-3.346374303049491e-05,0.1089737289948118,-0.01593152022512145,0.000223282082897044,0.01157848394740975,0.0694307682734599,0.0342781581227701,-0.002242892617426662,-0.008275227721379791,0.004970899359780534,0.0001034297429917641,0.1208158561738912,-0.01674973510332151,0.004398164928760944,0.01411354118860283,0.1601703359023087,0.04258183644239694,0.003389305168840311,-0.08472084403743588,0.3212027216474419,-0.03388811884065191,0.0397446399767664,-0.1614926756327554,-0.002519251804232547,0.1515382355655905,0.09716517603328961,0.02564857285895124,0.0003228853069372353,-0.01646974341694477,0.06349612693608854,-0.03147705339956177,0.002397037706686394,-0.007825841907096251,0.000138416902341557,0.004718667917534627,0.1067701148605111,0.02862105667601779,0.005146895554130558,-0.007937406634342906;

//K << 13.837723169203,24,116.5401050490325,148.9728165205601,-236.9654439799228,29.23073717058531,-18.02957349029655,108.7117695913673,-9.744042762271151,-8.890820992417423,15.53350006708795,8.73131954317204,71.29435165278717,30.23684787925646,-45.01466319730528,4.878680312843773,-14.61504267980006,4.980076612220296,-0.1570966393419414,-0.04652040473817585,0.1389262047891874,8.938856934620212,77.4138045160668,167.6346745679311,-11.03790874183252,-34.63065331976773,-133.3089676566997,141.7931220373545,257.1822602654864,-52.10968870514552,3.228969725288991,-117.4445237739586,14.85844094789661,11.3528140686922,-16.39656653480361,-18.3757558062922,-79.31294968894802,30.21211626602401,49.04202255502373,-8.752578016531045,13.36482701510968,-5.180827533845535,0.2143995021388636,-0.04666724265355447,-0.1863482032124266,-25.28302619053119,-90.24748737914366,164.7515191004754,-6.775147373053325,0.1292383516579119,0.0001005054891110174,-0.001345290869164879,0.01002774584023821,0.268261585980812,0.03104155600160171,-0.01536094855133527,-0.1449352740407893,0.1388154877458188,0.001742838208962234,0.0799174862252722,-0.001363931335849543,-0.0005871445753086739,0.003960640608023779,0.0544350827470469,0.02853058967139916,-0.001947995978590503,-0.007627127521963479,0.004667864632491492,3.545221684302566e-05,0.08492488618444238,0.001205620374754706,0.0004513236569168655,0.01164117477609766,0.08725548288471134,-0.03064570421450717,-0.006568670325650674,0.04278076588330455,0.1972993924987083,-0.03376486603078197,-0.0007712089537771896,-0.1215802095227357,-0.009217670643196981,0.1379128585841559,0.05595758134515811,-0.01598277193641899,-0.0008610002600684997,0.00478208682430644,0.0423232997535217,-0.02863515487939889,0.001792680304513526,-0.006949127555092958,-0.0001653148096068659,0.004495373551577062,0.05576160721313152,-0.02259583952211588,-0.004880109151084861,-0.009625437431687358;

//K << 14.11160133530956,121.2467690126525,147.7186682604377,-242.2668563772591,30.46158170324958,-18.32994346122256,113.3523287243322,-11.11336590382,-9.835245512745624,17.79131609309022,9.027360852911778,73.4704465865058,30.31674343449973,-46.50947332977488,5.244883458195381,-17.04821790852131,5.231343935274641,-0.2846114470506987,-0.09542346874868553,0.2099416363848616,8.810323119472615,79.49190287483228,168.2534531708204,3.327595098926066,-32.04066275055185,-139.959194017558,143.9680141468462,264.4491784242285,-48.13442199373126,17.95999753581535,-122.1792485861683,13.92096120970483,13.52943364530223,-18.35703023980762,-17.00390925026704,-82.35401080707517,30.20402431389531,50.77614299376013,-8.142923101738541,16.55925115027905,-5.41374170677958,0.2650339183058807,0.02165162651390194,-0.2463306204628568,-23.08943702760866,-93.81959148125137,165.5310040056516,-0.1065543517952497,0.1369210690241275,0.009847932417026953,0.001816106559074698,-0.00757879700409286,0.2828635513324395,0.03274848982141088,-0.009190802081099703,-0.1495131933173544,0.1361017856071534,0.007292907205615108,0.08416508813366169,0.00414231554066817,-0.000408485591605095,0.000788439641627517,0.05698210502668026,0.02489936993514859,-0.001818223477013197,-0.007611382433996912,0.004550535202307526,0.0001666417259449954,0.08932648610600308,0.007979172684848324,0.002072172778233977,0.0118117726539078,0.0903298169657125,-0.03426868336600952,-0.008688350283165563,0.04904703105720942,0.2031323236916366,-0.03238547488545066,-0.003758565326404845,-0.1239551420433995,-0.002570870893170441,0.1326934527396005,0.05779281485867634,-0.01783589947273604,-0.0008760191159083199,0.006160206138773509,0.04345476846539664,-0.02581253491184204,0.001704611922102803,-0.007072552086075887,-9.926133413044092e-05,0.004471418541533015,0.05710419404531132,-0.02489057013740589,-0.006364203464328021,-0.01374579397219645;

//K << 8.742763165342794,115.9008180525185,147.4274299441328,-233.2845902105101,21.32901877951807,-18.37219188968969,110.665023138101,-8.216806295118637,-11.13043408927499,17.60253747909714,6.000273910969922,70.48052633480832,30.27232096227572,-45.01708773376598,3.692500200031117,-16.97755707695235,5.211728160707817,-0.2228279281800403,-0.1215704236001947,0.1976203599211593,5.099488701799412,75.79692407766113,167.6623484396612,2.385258450939851,-28.18292213138191,-134.5180680531954,144.1826846627611,255.2993987349001,-41.5690357537279,18.17618395680229,-119.4356253637043,11.83430072695221,14.70635323426449,-18.46434795065644,-14.82834285774275,-79.3095582242287,30.23421421181922,49.25478652474529,-7.026426531608382,16.55635142125719,-5.394277710404306,0.2203432025899374,0.04452342472881284,-0.2413058160451891,-20.42255855736044,-90.05568957391556,165.9291369863272,0.8677803358141611,0.1315915172142581,0.006810313710898077,0.00157850990126092,-0.002465532318320831,0.2738016651422116,0.0331505132933067,-0.01075454976743806,-0.1466341621434714,0.1351916601178063,0.006729365356773856,0.08115943719638215,0.002440731523626605,-0.0004616868330625977,0.001644897069874514,0.05544093561823171,0.02510412520327643,-0.001836604997969997,-0.007548700937686073,0.004537389619645168,0.0001412385793532783,0.08563808966639894,0.005874834324742883,0.001622953034993047,0.01214200818780629,0.08902653402531721,-0.03028573809001037,-0.008554585318859432,0.04238718158679844,0.2009235265143672,-0.03199495420228769,-0.001790662243266283,-0.1232557645029862,-0.002037483628688864,0.1318023017596086,0.057059584300617,-0.01561323046698639,-0.0008812481607110718,0.005060367275541869,0.04307877243717251,-0.02556488472372119,0.001709933189088848,-0.007057246960673383,-8.42214843154038e-05,0.004446945409387707,0.05620003544072676,-0.02211574604244128,-0.006380664804317726,-0.0137008308808935;

//K<<7.466882844233271,194.9087275775703,194.3531666280136,-288.7828263527067,14.6848281894778,-9.997089480919279,121.5213963228059,-5.281313704732816,-9.716256417753467,14.45342985643968,4.501745656267474,99.05856039915381,31.88974316194729,-50.65789152928833,2.252651191593778,-30.28845882650816,4.965699386682158,-0.0567386417864412,-0.370871066285094,0.3675177829830081,5.426324955405748,174.322011287841,382.752748212004,-4.332971355440887,6.634660791191086,-194.0912960058028,185.9022527990966,280.7728567149247,13.91788324762066,11.52650835117464,-120.9035951441961,-5.469968841941984,19.57198150668975,-14.47459237231867,4.20878384104766,-97.17629091034974,31.90692673957017,49.95854223971634,2.217778509061651,31.58311389694284,-5.120056806868803,-0.08417790588947215,0.391356305604404,-0.3839046294853541,4.533307334242396,-175.7986665366522,384.8951632250831,0.6073806353628036,0.2433151508725958,0.01755329868111502,0.009772462221897685,-0.0212201816728552,0.3605949285424068,0.02211537053928787,0.004303864627591001,-0.1559243939532509,0.1085982611891824,0.03221410711964042,0.1232702411070993,0.008156740260205467,-0.0005819247300614227,-0.0028412141787951,0.06377553670645671,0.004766655939780064,-0.0004909093539438869,-0.006261554828726358,0.003869002060119005,0.0003220808227821896,0.2177955114760242,0.01694373336792117,-0.01093317111746506,0.01080620485464923,0.246509523697484,-0.02012597628555678,0.006751912337919344,0.02493296247290226,0.3650754661549854,-0.009686914079201218,-0.006007815163907439,-0.1576287437528926,0.03339349099981218,0.1087511990215132,0.1248508146893378,-0.009543126801524183,-0.0002296961952399155,0.003638096303434537,0.06455466752036893,-0.004377708804398407,0.0004082061821606832,-0.006315209293476328,0.0003206108736327789,0.003882515894094591,0.2206717413299758,-0.01886381826536004,-0.01139147651414451,-0.01364457606414482;

//K <<7.448160259389818,195.4466382421071,194.5212430222536,-289.6898620517461,14.65253657398568,-8.517587876839341,122.0278888797401,-5.261328083111945,-10.94557562491594,15.65889007318274,4.49061500205014,99.35582216560691,31.90887732847477,-50.84483266569236,2.246481532276665,-30.73563256720761,5.005800215831754,-0.05623084600519381,-0.4045899129096309,0.400588701128982,5.409091719250101,174.8210298092449,382.7997602304389,-0.8536568705037271,6.633285707331751,-194.4878497702727,186.3410841804559,281.4256254849983,13.93648429684321,10.54340310006734,-121.2668736689427,-5.482447112318503,20.46414245958139,-15.35190118286413,4.2151546134625,-97.39176083600073,31.92197653040939,50.09479833369739,2.221229459706692,31.917535009687,-5.149437136219624,-0.08461402526582985,0.4160799169681101,-0.4082745762013331,4.521961063814725,-176.1818541365357,386.7660370482549,-2.361348157734979,0.2432844946824108,0.01876437054917133,0.009561493562788641,-0.02319314653079811,0.360545172499523,0.02264139842036916,0.005354326752980212,-0.1558914639623113,0.1065871039359783,0.03419008491603208,0.1232550197186383,0.008809999093921928,-0.0005585909058222261,-0.003234977781630076,0.06376638316689069,0.003564099375959975,-0.0004206607282372207,-0.006260818965812073,0.003850583254168225,0.0003400524855434957,0.2177509853805535,0.01802008514895043,-0.009794483389079537,0.01436484169118805,0.2465292526872166,-0.0212370173950173,0.006948277966052725,0.02674129443011744,0.3651202903121998,-0.0102982237823194,-0.006968653871012879,-0.1576497995257556,0.03520563290143412,0.1069686125679732,0.1248622033860687,-0.01014354438368515,-0.000252658365195638,0.003999180656869157,0.06455916740928361,-0.003252339538137166,0.0003443478749525131,-0.006314800053581619,0.0003333934320655009,0.003869482127322455,0.2207043558870994,-0.01985777780729755,-0.0125276577311301,-0.01751156919954706;

//K << -0.8373216648012269,9.698515644648833,12.12302497627742,-22.58947846904054,-0.501830813143908,-0.1287590608060941,18.80192092907493,0.01943745989273702,-0.2803051795984696,0.2861448937853196,-0.4698101235487763,5.907429211183611,5.429828992744899,-5.546096903983835,-0.02397900175479249,-0.1463625995821851,2.143475658056272,-0.01388205763553398,-0.006323885666250283,0.0068772364201688,-0.7988490647373715,7.323757008634101,11.09552047472199,0.06312205732796332,-1.143361776020118,-11.61770717215947,11.38815887312887,23.76281692551752,-0.8434483330800433,0.1176119397462258,-18.75932331779264,0.1131186651902566,0.2237336376779603,-0.2699964125841762,-0.5983245207143421,-6.930717059133515,5.543657023348467,5.604028613499049,-0.07040280370217072,0.09316354723526095,-2.10389421164241,-0.01421318968857168,0.005275681525020092,-0.006116014722119613,-1.103875475868942,-9.195003240913856,9.837525117277089,-0.1265885874434181,0.2399122559921181,-0.02916139569735487,-0.001276131215174425,0.05241141605893732,0.3566769393627453,0.04115060999703776,-0.03624017074328495,-0.1554331264957137,0.1572333607644885,-0.01632302619794958,0.1212892926569912,-0.01612427319755395,-0.005458218634190999,0.01166417244773269,0.0634567768270513,0.03028945810409791,-0.003163342267330198,-0.006277306801875519,0.004403687840003689,-0.0002243530091907911,0.2154729686504126,-0.02377614010429566,0.007672480125788131,0.02631184551557766,0.2388257596367002,0.02283858090982091,0.001550460754514283,-0.05144470569146093,0.3539621300148513,-0.03618646103260142,0.04050519313608562,-0.1538212905892156,-0.02252414425459288,0.1614678875817682,0.1207046960365245,0.0137651676290485,-0.005059746006958231,-0.0115848135945727,0.06291643209576409,-0.02835370486482206,0.003877718208966537,-0.006235980475359714,-0.0001663374048682149,0.004335600027038348,0.2145116530553962,0.01833086690545891,0.01160341809788111,-0.01575552208112183;

//K << -2.319565408794358,29.02319109405349,23.91169057109213,-55.28896735231682,-0.5791369088968968,0.4903998704351859,34.67083360082223,-0.06277851978437016,0.7613039213361781,-0.6948822009003024,-0.8905092876350875,16.38517195846443,7.829637227932579,-11.62943140130305,-0.0171074357951095,0.4392002542325201,2.756837456516288,-0.02171749063471531,0.005579356368309899,-0.005150540106810433,-2.539188742714532,23.70871638994549,29.08013835405837,0.3861409316265305,-2.741348663985173,-34.19293597658479,21.8467283530164,57.17155738563724,-1.075637799499288,-0.6591922126838102,-34.92750566544943,0.09930240781309042,-0.6473175133629538,0.6234780781866349,-1.068288265972544,-18.39608805422922,7.707540677888169,11.7976085149735,-0.08485595186573477,-0.4752317765311742,-2.755736561828128,-0.0236913229265709,-0.007103546977863492,0.006934575533040957,-2.980100450792274,-29.30867565781367,25.92630564496617,-0.4265712951394002,0.2423382441388362,-0.03724375582703991,0.007744821140710137,0.06357519102861918,0.3601486279537602,0.05326617568308898,-0.03769973579651703,-0.1563691347435432,0.1631260257194927,-0.02198636440944,0.1228184201172361,-0.02013366017565518,-0.0002492113126384901,0.01319680292935335,0.06384873363604933,0.04116288248162064,-0.002928879602217614,-0.006290953742766395,0.004673610760282317,-0.0004816036867268076,0.2173428300107359,-0.0310422519972286,0.009732204916020766,0.02853194756577931,0.2416271561853116,0.02231667867557911,0.009499682806664314,-0.04405747759118409,0.3585398681393244,-0.04540799693845913,0.02961817707212163,-0.1554351376746815,-0.0232776661620616,0.1638062114242299,0.1224432114853163,0.01281806812406908,-0.0002469828764372233,-0.009458938201394892,0.06355763652681942,-0.03637960703475908,0.002546179055724687,-0.006245231919407001,-0.0004298064149065193,0.004607004664231055,0.2167268307742505,0.0186371223331008,0.0125655942100949,-0.02520000990090497;

//K << -1.591982185246746,91.15933270355508,52.30137364458048,-146.082911275284,2.258052781204642,-1.3194432176504,70.00182903697935,-0.8564181107802013,0.1732828393778527,0.3738932541615251,-0.04300821274016197,48.04219258558937,12.29176885605635,-27.14626541204111,0.3305777283766176,-2.30383067645365,3.758506474330537,-0.02152553060902632,0.002665700551219257,-0.0009426285443396231,-2.388326555061444,79.361476859211,82.06619336060039,-0.6735780612327825,-2.401120876452816,-95.44528715462525,49.31922437137319,143.4096709581463,1.305128692260351,1.965597779511979,-69.46512223036648,-0.62478439601472,2.121462997024795,-1.687594200376313,-0.4202547070297262,-48.71187069325314,12.08766038451658,26.83692147426237,0.2127214945541384,3.04438378231385,-3.802195872067759,-0.03149639632489566,0.04461191504628202,-0.04066187608521193,-3.196999094512135,-85.0872849334809,77.96555116276404,0.4014233193618281,0.243450325232219,-0.007578222810357081,0.007188169522679719,0.0160604679728047,0.3613728161825978,0.03181109725467275,-0.01246673202510278,-0.1566727839061998,0.1317250068148007,0.00973169004702729,0.1234312745898289,-0.004571783307359122,-0.0002976720699453291,0.004015671542346874,0.06391654377195917,0.01455792275582398,-0.00138106122523059,-0.006283949523692121,0.004390919980757873,-0.0001836969351647132,0.2181172175419803,-0.005330008122101286,0.002384414011621911,0.01382567956256845,0.2452511507994092,-0.000958061680563413,0.006855776333679538,-0.004536378890552433,0.3636870240280916,-0.01869415823188903,0.007617284471284821,-0.157343348929724,0.01210393205068792,0.129702688563471,0.1242879811573215,0.00034825623891466,-0.0003120655576893035,-0.00163884417321408,0.06429071716856095,-0.01154730581214681,0.00108058047697099,-0.006291015603700244,-0.0001354650621634102,0.004331044250186824,0.219779174112607,-0.001527302424761336,0.00211022964766654,-0.01592189811365807;

//K <<-0.9751088079461805,102.5177667929437,66.35698054807386,-162.5752353222538,1.388941296274011,-1.769014132552736,73.72618414748315,-0.5300471626497095,-2.516411122597642,2.77370979242846,-0.08845500053933003,55.59448498995326,19.31731768056737,-29.03616194797613,0.2145834380611541,-2.854724269342525,3.846052361757148,-0.02128340168593506,-0.05984001874400552,0.05876404297955665,-1.231965531282992,84.7575124704739,87.56456226602693,-0.6170209671165328,-1.671619140217621,-105.4381120990532,64.56873458112611,161.2202374573434,0.5916425349204605,1.584635422993387,-73.28427780905088,-0.4033102495353126,2.78749422806846,-2.539934699246364,-0.4270855892516675,-56.27729571488972,19.21637671679595,28.82474618524766,0.1327403604363687,2.77320759765005,-3.834580227405763,-0.03254687287906909,0.05410263278582592,-0.05219593422184577,-1.863141014971739,-88.00646943978383,85.35905072128733,0.07903861472655932,0.2832369816751161,-0.004621174348250495,0.007376406403662576,0.0108100130075733,0.4198240360994842,0.03075146104813433,-0.008374094551638747,-0.1703843723221293,0.1199326705670592,0.03042820624814676,0.1488202946251219,-0.00303667106805386,-0.0003311552586774474,0.002752182386878216,0.07073409473196544,0.01093600593480554,-0.0009697945850706074,-0.006338784445916386,0.004083842684985,0.0002955863357142709,0.2389966509276813,-0.003024632379594314,-0.002850799187403612,0.01282349844797186,0.2862276094622099,-0.0001377603432249957,0.006935525968811689,-0.003885977327085133,0.4239669175736063,-0.01575639842214935,0.005357783618467498,-0.1718124656055589,0.03235051793950729,0.1190754763628766,0.1503284010469219,0.0004841953634115568,-0.0002069204313754494,-0.001317384312280102,0.07139451469343193,-0.009525243191159227,0.0008036836624015823,-0.006373791726561804,0.0003167343805210127,0.004071172142210589,0.2415719154693996,-0.0005168778956764267,-0.003386287388310106,-0.01588123164542793;

//K << 0.5065042665423784,147.3703285129471,100.149051780894,-228.3016170934649,1.459323413450579,-0.8200936710590745,85.20160322495491,-0.4048748253566521,-2.33442227194754,2.254879844376755,0.3805553925074182,88.22083748784186,42.31497227803394,-35.39475252310928,0.1931825964397082,-2.722968754423606,3.75446655705401,-0.01636252315815956,-0.05725981003922246,0.05439879251763349,0.2784884931501104,100.9145871138121,91.2628799387153,-0.8326187884955251,-0.3510823459638419,-148.2367649163749,99.19499124827622,227.9837011307445,0.4277171626389778,0.5780589745695302,-85.09770420267674,-0.2487823016537323,2.173486857396907,-2.275173827301071,-0.09771214238825837,-88.54426895381924,42.1954144468905,35.34162730158884,0.1005003084666622,2.681361328095576,-3.749306810872745,-0.0269069487508078,0.04523566733611418,-0.04636128311111013,-0.3599403984739088,-101.6403918111616,90.60870371176948,0.5728635977340781,0.4201332865320168,-0.008941169629568809,0.009665311468082371,0.02054924361206038,0.6141021019567425,0.04298506626081173,-0.01186856291335461,-0.2039907542148552,0.1308148018236869,0.03478778590605738,0.2460976367139729,-0.00645870288630946,5.928287494843473e-05,0.004536299906008095,0.08891589467015036,0.01528933161476712,-0.001222420198813977,-0.005884169138408443,0.004298182995740075,0.0003441973826997813,0.2912738170161466,-0.005930973546307596,-0.005214256793839207,0.01673656955239275,0.4236464355176765,0.004836809420159312,0.01383675910908435,-0.01280602102156936,0.618842466439031,-0.02456971409891185,0.008881119191541999,-0.205325059301826,0.03752435569384303,0.1289469262263598,0.2479842569370818,0.00368167682225836,0.0003794141057407165,-0.003187267722457388,0.089517623476222,-0.01375544189568733,0.001084013737626006,-0.005905967536745451,0.0004052118609207741,0.004243001280876857,0.2937871947474552,0.00278495456123167,-0.002524597764779386,-0.01847670469032463;

//K << -0.8912604224448189,66.44644375507065,52.68253787813642,-131.5429979274152,1.596269560006546,-1.263411953611515,64.27170326060261,-0.7157425310164599,2.599415085994088,-2.178858584719805,-0.1082330899912843,41.46934734805468,18.44964511657034,-24.75894465037488,0.2753776209160596,0.4844141261563708,3.547320596889067,-0.03291539460695358,-0.004820312549363629,0.008457562844397516,-0.8845881735152036,43.79821694284016,49.91972427799786,0.7036479579064205,-2.032734803583961,-69.55742355586425,51.10808911502407,130.7908319044639,-0.2641842503638279,1.281209055395002,-63.96207347185676,-0.1206050330799016,-2.27843171939522,2.336810885624743,-0.7732867844183872,-42.49195744001742,18.35275337036966,24.62263711995348,-0.00458121590935126,-0.5473966148897382,-3.537117615091056,-0.02570761568741461,0.002994069300545361,-0.005345331965637606,-1.653631327923264,-46.43470719214744,48.32909851675176,-0.6467075966585955,0.1674061329731215,-0.009222555289846248,0.002100713308978393,0.02425138286188529,0.3101200091956393,0.03174685905987591,-0.01809868724704092,-0.1379268916583954,0.1383930524939708,-0.01150293194169955,0.101559961122436,-0.006473568932407669,-0.0003385691969997758,0.005702276235977258,0.05578238473593779,0.01973242279558175,-0.001739169226712499,-0.005913193044721171,0.004399647175134354,-0.0003961022857843518,0.1122404260460557,-0.005440053894934238,0.0001103693436918991,0.01310548681878059,0.1677689243096203,0.008368836193641437,0.002545767953746717,-0.02293147670408512,0.3104324036072819,-0.02565494338362586,0.0173978131200116,-0.1376817350837056,-0.01172625567130057,0.138094814457684,0.1017373374515109,0.006020889575285685,-0.000276462130545706,-0.005351712602987085,0.05580280227928531,-0.0186015457903794,0.001700680069216109,-0.005892814764562783,-0.0003786469000103697,0.004352793286978391,0.1125139454701823,0.005003751508340082,0.0004357650511772097,-0.01395327427039267;

//K<<8.429439532971857,16.05617755076144,37.07938385418388,-71.2617871666348,17.62355507053237,-13.66694454457599,73.10804113527651,-4.800673695749501,1.067500090833888,0.7220076587434935,5.167395778076668,15.23433517615273,10.45436254798066,-19.23467680021457,2.883800998111045,-4.45101913189834,5.259458670756892,0.1013261582363687,0.002213326558479061,0.01211653469825221,6.097664514941126,5.679067736094367,40.96756729809198,-11.13647978109905,-0.5753816885390289,-8.272213479879397,37.14427334450186,50.34581623379143,3.682929311629978,8.312237199863752,-67.59393271734942,-0.8893946096405339,2.78200029886379,-2.33055448505245,0.361363893679187,-9.800930248545793,10.77160656244295,15.82761654067944,0.6023570654305688,5.293956091340765,-5.415736752457628,0.004131895141467971,0.07258218929476301,-0.06985414372704935,-1.104251884491646,-0.5698853630625419,42.96653364416439,3.042463724627328,0.08248646082138161,0.1108980401712491,0.003371284082963473,-0.1687289171619049,0.2581689902417735,0.02802539866403734,0.04257464372641063,-0.2343201151977235,0.1669752729174104,0.04021664584293667,0.06301156978723593,0.05867491677108834,-0.001543911645795583,-0.02710542049419852,0.06528589123626244,0.02053373655093833,-0.001843604144388101,-0.01507306712337612,0.005022488839894538,0.0003294381904231527,0.04372294390220548,0.08722942865416659,0.01973932554902342,0.02788483162589581,0.05963514502521946,-0.1141759220345529,0.001768835683264028,0.1740102196677191,0.2225026844724864,-0.0336865547847904,-0.0447749026699968,-0.2240241190778305,0.0292142977756578,0.1746351939070229,0.05059029778307526,-0.06017441763755577,-0.0005433612740080395,0.02814445188909415,0.05924329072299326,-0.02397005480466365,0.001799315494806833,-0.01522787363377711,3.303809514482243e-05,0.005261139156551924,0.02794901907881306,-0.09000768248323413,-0.01189195110218981,-0.02943486678297375;

//K <<
//-1.707530551705446,42.07103488156846,39.21177844130946,-112.1246227495927,1.983482733253819,-11.80420325341408,80.92693361192825,-0.4253139990126405,-0.4697611500174702,0.8555346104167357,-0.2097259009665767,29.13459110139521,10.91556155375823,-25.70874504130355,0.2811087217335758,-0.8861339680642301,4.197072236018313,0.0100733103866324,-0.001969726026695298,-0.004162483549312634,-1.871610470946463,25.97165513382148,43.57506976160737,-7.794315770040856,-2.994445114385786,-45.22916494664401,37.82651744596762,107.6198506010116,0.09411907297383777,8.844118751439746,-79.9282382008805,-0.03393191130924955,1.157111787457616,-0.9233526866469096,-0.8916604864876943,-29.39062526021448,10.74346645789786,25.01334528812202,-0.01683016348743795,1.113741738549042,-4.202759767963355,-0.01998900483473987,0.01327638006466491,-0.01357917734322155,-2.780241563952908,-29.29175650714354,41.4721483619,1.039679311075288,0.1031466687474173,0.08964312942937935,0.002613196357762351,-0.1305531534669487,0.2733674911894781,0.03656122096651818,0.01690308559321528,-0.2084892247613217,0.1501455242731775,0.01595233697848693,0.07138485924812453,0.0466372395869776,-0.0004377316663138692,-0.01960060374942338,0.06377595631800739,0.02934030978341803,-0.002351419192125904,-0.01036610649146549,0.004845394629700042,0.0001138987035213339,0.06259904823027285,0.06998178104049675,0.0100224862856309,0.02971201734247455,0.1057986750641937,-0.109417611600219,0.0003538211661373871,0.1621095081612783,0.2773637347574581,-0.03669648170517305,-0.02549888922191809,-0.2087789486251634,0.01362305447137598,0.1520551102532954,0.07282932284769846,-0.05727157222975973,-0.0001290195492797094,0.02505861208816964,0.06442942147405163,-0.03194376577930694,0.002338469153228667,-0.0103484320658487,-2.232234114806581e-05,0.004960203315319384,0.06497403222999845,-0.08618874384543014,0.002889446649392386,-0.0141996853147276;

//K << 1.434777734082564,42.42657351025635,39.03428243295047,-119.3949258965087,6.9973037067305,-10.43666818099443,90.39750211722216,-1.841776081452576,-0.3686929073040027,1.413277479698478,1.493939545944499,30.26287751250907,10.88700401610285,-28.01850145875683,1.128638583909332,-1.102375644914381,4.340755715651027,0.02440317618841121,0.007690222564461922,-0.001797911541948716,0.4884634075156831,25.24765743426215,43.8587028597623,-5.420210550606222,-3.252091502189576,-45.25092479923301,38.01276666268695,114.542696032505,-0.1686680746288263,9.584430691686062,-89.57173285390689,-0.04555064155701678,1.677917978037078,-1.460193744957518,-1.007245765668368,-30.35939929260556,10.78936822982477,27.31012662225355,-0.021574927969474,1.651486601617673,-4.372810448516106,-0.02689718726996138,0.02557376455674811,-0.02509283160707591,-3.000649145515915,-28.37198478279777,41.64127869683114,1.954385937871135,0.07192782793528235,0.1085007454264841,0.002325877535059224,-0.1610031067510218,0.1965172352982093,0.03136962852224387,0.02129087583957157,-0.1567018461924752,0.1362042711068388,0.008893699951153085,0.05075316946916079,0.05682171301254087,-0.0003011949584116707,-0.02477483044688025,0.04697050634090392,0.02785196008837435,-0.002484505234913074,-0.009335674679614039,0.004653002592660234,2.543275675818199e-06,0.04295236208064964,0.08524755619605021,0.006800081463287182,0.02113800113499952,0.05947175628556498,-0.1079756861673115,-0.001891437974298934,0.1613290871903716,0.1763580729586925,-0.03654664667487804,-0.02264523193433392,-0.1507356130921049,0.005230432107918566,0.1365283960807087,0.04390770193682839,-0.05665404187098814,-0.000135665932410584,0.02493400801202587,0.04360005824440699,-0.03010814891315781,0.00244304465006881,-0.009398335923968736,-0.000111832257251024,0.00468893455105622,0.03386805644889472,-0.08498711278134594,-0.002836290292166488,-0.02117555067841381;

//K<<0.9587417950710254,56.12444279144602,43.8982288546167,-134.8803493169799,6.10996396174102,-10.70958738887864,92.34234218111769,-1.744068129984721,-0.8797091003034616,1.850453371360082,1.246869859072913,36.50615124801436,11.41644462789959,-30.01252916830877,0.9697148136687517,-1.562330672771187,4.316041759523413,0.007243658708144818,-0.01274147784720973,0.01915348158187196,0.08164740511323888,38.05708796054574,56.23289211763898,-4.393460195945947,-2.287429515869982,-61.96092970017797,41.61592930339263,134.840832443327,1.236244689296703,9.421487156805908,-92.59862750417597,-0.3523820462743502,1.552302065256986,-1.214416017338975,-0.4519962463775359,-38.118541706227,11.23602078123112,30.12506576748324,0.1958111170648426,1.290187691715937,-4.289088401408121,-0.02019206719519592,0.007290382813435994,-0.004155311139758857,-2.580386371006924,-44.15916154101276,53.81665541443612,2.270346212415092,0.08757469634210188,0.1097477603749454,0.001056228023805468,-0.157484846621697,0.2034619344165525,0.04101141703353146,0.02408363902871411,-0.14774578902366,0.1392541125993363,0.001762306935926524,0.05615864386614641,0.05622721351617396,6.140845191112985e-05,-0.02461432594290207,0.0462541784248838,0.03004981944945835,-0.002535794764598317,-0.008927400704927686,0.004765831686681198,-0.0001367526122564443,0.06002983592205033,0.09271662360158788,0.003544268628983155,0.02564491515472527,0.06307467289441332,-0.1018123463750588,-0.001724932756887732,0.1468785383382971,0.165409667147451,-0.04292644888159672,-0.02325943552807894,-0.1354523522521419,-0.0005891578597718749,0.1352057121228516,0.04316812723091203,-0.05225623679549163,-0.0003665404586792554,0.02299658320576295,0.03973833515599646,-0.02948649458011966,0.002347941908339182,-0.008898729245089589,-0.0001334454978473342,0.00461132705952576,0.04012157034115564,-0.08607373369147167,-0.001254763742862946,-0.02443956074044499;
	}
	public: std::vector<double> execute(simulator_msgs::SensorArray arraymsg)
	{
		static float count = 0;

                static float xint, x_ant = 0;
                static float yint, y_ant = 0;
                static float zint, z_ant = 0;
                static float yawint, yaw_ant = 0;
	
		// selecionando dados
		int i = 0;		
		simulator_msgs::Sensor msgstates;
		msgstates = arraymsg.values.at(0);		

		// Reference

		float trajectoryRadius = 2;
		float trajectoryHeight = 4*trajectoryRadius;
		float trajTime = 80;
		float pi = 3.14;

		float x = trajectoryRadius*cos((count*T)*2*pi/trajTime);
		float xdot = -trajectoryRadius*(2*pi/trajTime)*sin((count*T)*2*pi/trajTime);
		float xddot = -trajectoryRadius*(2*pi/trajTime)*(2*pi/trajTime)*cos((count*T)*2*pi/trajTime);

		float y = trajectoryRadius*sin((count*T)*2*pi/trajTime);
		float ydot = trajectoryRadius*(2*pi/trajTime)*cos((count*T)*2*pi/trajTime);
		float yddot = -trajectoryRadius*(2*pi/trajTime)*(2*pi/trajTime)*sin((count*T)*2*pi/trajTime);

		float z = trajectoryHeight+1 - trajectoryHeight*cos((count*T)*2*pi/trajTime);
		float zdot = trajectoryHeight*(2*pi/trajTime)*sin((count*T)*2*pi/trajTime);
		float zddot = trajectoryHeight*(2*pi/trajTime)*(2*pi/trajTime)*cos((count*T)*2*pi/trajTime);
		
			
		//Xref << 2,0,1,0,0,0,0.00002965,0.004885,0.004893,0.00484,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
		Xref << x,y,z,0,0,0,0.00002965,0.004885,0.004893,0.00484,xdot,ydot,zdot,0,0,0,0,0,0,0,0,0,0,0;

		//Convertendo velocidade angular
                std::vector<double> etadot = pqr2EtaDot(msgstates.values.at(13),
                                                         msgstates.values.at(14),
                                                         msgstates.values.at(15),
                                                         msgstates.values.at(3),
                                                         msgstates.values.at(4),
                                                         msgstates.values.at(5));

                // Integrador Trapezoidal
		float x_atual = msgstates.values.at(0) - Xref(0);
                xint = xint + (T/2)*(x_atual + x_ant);
                x_ant = x_atual;
                float y_atual = msgstates.values.at(1) - Xref(1);
                yint = yint + (T/2)*(y_atual + y_ant);
                y_ant = y_atual;
                float z_atual = msgstates.values.at(2) - Xref(2);
                zint = zint + (T/2)*(z_atual + z_ant);
                z_ant = z_atual;
                float yaw_atual = msgstates.values.at(5) - Xref(5);
                yawint = yawint + (T/2)*(yaw_atual + yaw_ant);
                yaw_ant = yaw_atual;

		// vetor de estados aumentado
                X << msgstates.values.at(0),//x
                     msgstates.values.at(1),//y
                     msgstates.values.at(2),//z
                     msgstates.values.at(3),//roll
                     msgstates.values.at(4),//pitch
                     msgstates.values.at(5),//yaw
                     msgstates.values.at(8),//g1 x
                     msgstates.values.at(9),//g2 y
                     msgstates.values.at(6),//aR
                     msgstates.values.at(7),//aL
                     msgstates.values.at(10),//vx
                     msgstates.values.at(11),//vy
                     msgstates.values.at(12),//vz
                     etadot.at(0),//droll
                     etadot.at(1),//pitch
                     etadot.at(2),//yaw
                     msgstates.values.at(18),
                     msgstates.values.at(19),
                     msgstates.values.at(16),
                     msgstates.values.at(17),
                     xint,
                     yint,
                     zint,
                     yawint;


		// lei de controle
		Erro = X-Xref;
		Input = -K*Erro;

		Eigen::MatrixXd qref(10,1);
		qref << x,y,z,0,0,0,0.00002965,0.004885,0.004893,0.00484;
		Eigen::MatrixXd qrefdot(10,1);
		qrefdot << xdot,ydot,zdot,0,0,0,0,0,0,0;
		Eigen::MatrixXd qrefddot(10,1);
		qrefddot << xddot,yddot,zddot,0,0,0,0,0,0,0;
		Eigen::MatrixXd  varfeedforward  = feedforward::compute(qref,qrefdot,qrefddot);

		// Feedforward
                //Input(0) = Input(0) + 12.6005;
                //Input(1) = Input(1) + 12.609;
		Input(0) = Input(0) + varfeedforward(0,0);
		Input(1) = Input(1) + varfeedforward(1,0);
		Input(2) = Input(2) + varfeedforward(2,0);
		Input(3) = Input(3) + varfeedforward(3,0);
		count++; 

		std::vector<float> out2(Input.data(), Input.data() + Input.rows() * Input.cols());

		std::vector<double> out(out2.size());
		for(int i=0; i<out2.size();i++) out.at(i) = out2.at(i);
		return out;
	}

	public: std::vector<double> Reference()
	{
		std::vector<double> out(Xref.data(), Xref.data() + Xref.rows() * Xref.cols());
		return out;
	}

	public: std::vector<double> Error()
	{
		std::vector<double> out(Erro.data(), Erro.data() + Erro.rows() * Erro.cols());	
		return out;
	}	

	public: std::vector<double> State()
	{
		std::vector<double> out(X.data(), X.data() + X.rows() * X.cols());
		return out;
        }

        private: std::vector<double> wIIL2EtaDot(double in_a, double in_b, double in_c, double phi, double theta, double psii)
        {
            std::vector<double> out;
            out.push_back((in_a*cos(psii) + in_b*sin(psii))/cos(theta));
            out.push_back(in_b*cos(psii) - in_a*sin(psii));
            out.push_back(in_c + in_a*cos(psii)*tan(theta) + in_b*sin(psii)*tan(theta));
            return out;
        }

        private: std::vector<double> pqr2EtaDot(double in_a, double in_b, double in_c, double phi, double theta, double psii)
        {
            std::vector<double> out;
            out.push_back(in_a + in_c*cos(phi)*tan(theta) + in_b*sin(phi)*tan(theta));
            out.push_back(in_b*cos(phi) - in_c*sin(phi));
            out.push_back((in_c*cos(phi))/cos(theta) + (in_b*sin(phi))/cos(theta));
            return out;
        }
};

extern "C"
{ 
	Icontroller *create(void) {
		return new hinfinity;
	}
	void destroy(Icontroller *p) {
		delete p;
	}
}
